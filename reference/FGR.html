<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Formula interface for Fine-Gray regression competing risk models."><title>Formula wrapper for crr from cmprsk — FGR • riskRegression</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Formula wrapper for crr from cmprsk — FGR"><meta property="og:description" content="Formula interface for Fine-Gray regression competing risk models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">riskRegression</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2022.09.29</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/IFAUC.html">Derivation of the Influence Function for AUC for competing risk data and survival data</a>
    <a class="dropdown-item" href="../articles/IFBrier.html">Influence function calculation for Brier score for event time data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tagteam/riskRegression/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Formula wrapper for crr from cmprsk</h1>
      <small class="dont-index">Source: <a href="https://github.com/tagteam/riskRegression/blob/HEAD/R/FGR.R" class="external-link"><code>R/FGR.R</code></a></small>
      <div class="d-none name"><code>FGR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Formula interface for Fine-Gray regression competing risk models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FGR</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, cause <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>A formula whose left hand side is a <code>Hist</code> object -- see
<code><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></code>.  The right hand side specifies (a linear combination of)
the covariates. See examples below.</p></dd>


<dt>data</dt>
<dd><p>A data.frame in which all the variables of <code>formula</code> can be
interpreted.</p></dd>


<dt>cause</dt>
<dd><p>The failure type of interest. Defaults to <code>1</code>.</p></dd>


<dt>y</dt>
<dd><p>logical value: if <code>TRUE</code>, the response vector is returned in component <code>response</code>.</p></dd>


<dt>...</dt>
<dd><p>...</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>See <code>crr</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Formula interface for the function <code>crr</code> from the <code>cmprsk</code>
package.</p>
<p>The function <code>crr</code> allows to multiply some covariates by time before
they enter the linear predictor. This can be achieved with the formula
interface, however, the code becomes a little cumbersome. See the examples.
Note that FGR does not allow for delayed entry (left-truncation).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gerds, TA and Scheike, T and Andersen, PK (2011) Absolute risk
regression for competing risks: interpretation, link functions and
prediction Research report 11/7. Department of Biostatistics, University of
Copenhagen</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="riskRegression.html">riskRegression</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Alexander Gerds <a href="mailto:tag@biostat.ku.dk">tag@biostat.ku.dk</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">prodlim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.R-project.org" class="external-link">cmprsk</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/lava/" class="external-link">lava</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘lava’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:zoo’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     index, index&lt;-</span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">prodlim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/SimCompRisk.html" class="external-link">SimCompRisk</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu">FGR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Argument cause missing. Analyse cause: 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Right-censored response of a competing.risks model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.Observations: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pattern:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cause     event right.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1          50              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2          29              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   unknown     0             21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fine-Gray model: analysis of cause 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Competing Risks Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FGR(formula = Hist(time, cause) ~ X1 + X2, data = d, cause = "1")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     coef exp(coef) se(coef)    z p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1 0.834      2.30    0.309 2.70 6.9e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2 0.723      2.06    0.137 5.28 1.3e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    exp(coef) exp(-coef) 2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      2.30      0.434 1.26  4.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2      2.06      0.485 1.58  2.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. cases = 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo Log-likelihood = -190 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo likelihood ratio test = 28.3  on 2 df,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## crr allows that some covariates are multiplied by</span></span></span>
<span class="r-in"><span><span class="co">## a function of time (see argument tf of crr)</span></span></span>
<span class="r-in"><span><span class="co">## by FGR uses the identity matrix</span></span></span>
<span class="r-in"><span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">FGR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X1</span><span class="op">)</span><span class="op">+</span><span class="va">X2</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Argument cause missing. Analyse cause: 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Right-censored response of a competing.risks model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.Observations: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pattern:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cause     event right.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1          50              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2          29              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   unknown     0             21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fine-Gray model: analysis of cause 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Competing Risks Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FGR(formula = Hist(time, cause) ~ cov2(X1) + X2, data = d, cause = "1")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         coef exp(coef) se(coef)    z p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     0.740      2.10   0.1368 5.41 6.4e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1*tf1 0.135      1.14   0.0613 2.21 2.7e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        exp(coef) exp(-coef) 2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2          2.10      0.477 1.60  2.74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1*tf1      1.14      0.873 1.02  1.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. cases = 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo Log-likelihood = -191 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo likelihood ratio test = 25.8  on 2 df,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## same thing, but more explicit:</span></span></span>
<span class="r-in"><span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu">FGR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X1</span><span class="op">)</span><span class="op">+</span><span class="fu">cov1</span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Argument cause missing. Analyse cause: 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Right-censored response of a competing.risks model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.Observations: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pattern:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cause     event right.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1          50              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2          29              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   unknown     0             21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fine-Gray model: analysis of cause 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Competing Risks Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FGR(formula = Hist(time, cause) ~ cov2(X1) + cov1(X2), data = d, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cause = "1")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         coef exp(coef) se(coef)    z p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     0.740      2.10   0.1368 5.41 6.4e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1*tf1 0.135      1.14   0.0613 2.21 2.7e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        exp(coef) exp(-coef) 2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2          2.10      0.477 1.60  2.74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1*tf1      1.14      0.873 1.02  1.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. cases = 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo Log-likelihood = -191 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo likelihood ratio test = 25.8  on 2 df,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## both variables can enter cov2:</span></span></span>
<span class="r-in"><span><span class="va">f4</span> <span class="op">&lt;-</span> <span class="fu">FGR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X1</span><span class="op">)</span><span class="op">+</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Argument cause missing. Analyse cause: 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Right-censored response of a competing.risks model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.Observations: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pattern:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cause     event right.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1          50              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2          29              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   unknown     0             21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fine-Gray model: analysis of cause 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Competing Risks Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FGR(formula = Hist(time, cause) ~ cov2(X1) + cov2(X2), data = d, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cause = "1")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          coef exp(coef) se(coef)    z p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1*tf1 0.1361      1.15   0.0611 2.23   0.026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2*tf2 0.0985      1.10   0.0434 2.27   0.023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        exp(coef) exp(-coef) 2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1*tf1      1.15      0.873 1.02  1.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2*tf2      1.10      0.906 1.01  1.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. cases = 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo Log-likelihood = -198 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo likelihood ratio test = 12.1  on 2 df,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## change the function of time</span></span></span>
<span class="r-in"><span><span class="va">qFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">noFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">sqFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">^</span><span class="fl">0.5</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## multiply X1 by time^2 and X2 by time:</span></span></span>
<span class="r-in"><span><span class="va">f5</span> <span class="op">&lt;-</span> <span class="fu">FGR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X1</span>,tf<span class="op">=</span><span class="va">qFun</span><span class="op">)</span><span class="op">+</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Argument cause missing. Analyse cause: 1</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in qFun(c(0.223312599010185, 0.844653052602936, 0.86743957909998, 0.869654848917858, 1.4718454380646, 1.47986846377743, 1.56788544286003, 1.57284176822651, 1.71280654079967, 1.7446175554818, 2.08017045127398, 2.11900022748555, 2.34027091945108, 2.44735526652256, 2.47481572672078, 2.69072148768644, 2.69930631257876, 2.82681955875637, 2.86986677073091, 3.28835303045329, 3.38016548882937, 3.42930837661085, 3.57927210122299, 3.61310741873331, 3.71589696889436, 3.82638651755888, 4.13125614409393, 4.22817648821086, 4.69740197012358, 4.75934581546958, 4.7989296471193, 5.09144457759695, 5.20599159981632, 5.27409575450788, 5.37841476839829, 5.45365210472182, 5.47792252614271, 5.8344164585106, 6.03541407396753, 6.63251816105419, 6.92722896832721, 7.2931295159595, 7.59440495376659, 7.82755206098875, 8.10614220085668, 8.1127149986577, 8.83868607919211, 9.05983471886304, 9.33426459771812, 10.6845775000325)):</span> could not find function "qFun"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f5</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in print(f5):</span> object 'f5' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f5</span><span class="op">$</span><span class="va">crrFit</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in print(f5$crrFit):</span> object 'f5' not found</span>
<span class="r-in"><span><span class="co">## same results as crr</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">d</span>,<span class="fu"><a href="https://rdrr.io/pkg/cmprsk/man/crr.html" class="external-link">crr</a></span><span class="op">(</span>ftime<span class="op">=</span><span class="va">time</span>,</span></span>
<span class="r-in"><span>           fstatus<span class="op">=</span><span class="va">cause</span>,</span></span>
<span class="r-in"><span>           cov2<span class="op">=</span><span class="va">d</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>           tf<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu">qFun</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,<span class="va">time</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> convergence:  TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  X1*tf1 X2*time </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.01259 0.09674 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.00853 0.04345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> two-sided p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  X1*tf1 X2*time </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.140   0.026 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## still same result, but more explicit</span></span></span>
<span class="r-in"><span><span class="va">f5a</span> <span class="op">&lt;-</span> <span class="fu">FGR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X1</span>,tf<span class="op">=</span><span class="va">qFun</span><span class="op">)</span><span class="op">+</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X2</span>,tf<span class="op">=</span><span class="va">noFun</span><span class="op">)</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Argument cause missing. Analyse cause: 1</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in qFun(c(0.223312599010185, 0.844653052602936, 0.86743957909998, 0.869654848917858, 1.4718454380646, 1.47986846377743, 1.56788544286003, 1.57284176822651, 1.71280654079967, 1.7446175554818, 2.08017045127398, 2.11900022748555, 2.34027091945108, 2.44735526652256, 2.47481572672078, 2.69072148768644, 2.69930631257876, 2.82681955875637, 2.86986677073091, 3.28835303045329, 3.38016548882937, 3.42930837661085, 3.57927210122299, 3.61310741873331, 3.71589696889436, 3.82638651755888, 4.13125614409393, 4.22817648821086, 4.69740197012358, 4.75934581546958, 4.7989296471193, 5.09144457759695, 5.20599159981632, 5.27409575450788, 5.37841476839829, 5.45365210472182, 5.47792252614271, 5.8344164585106, 6.03541407396753, 6.63251816105419, 6.92722896832721, 7.2931295159595, 7.59440495376659, 7.82755206098875, 8.10614220085668, 8.1127149986577, 8.83868607919211, 9.05983471886304, 9.33426459771812, 10.6845775000325)):</span> could not find function "qFun"</span>
<span class="r-in"><span><span class="va">f5a</span><span class="op">$</span><span class="va">crrFit</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'f5a' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## multiply X1 by time^2 and X2 by sqrt(time)</span></span></span>
<span class="r-in"><span><span class="va">f5b</span> <span class="op">&lt;-</span> <span class="fu">FGR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X1</span>,tf<span class="op">=</span><span class="va">qFun</span><span class="op">)</span><span class="op">+</span><span class="fu">cov2</span><span class="op">(</span><span class="va">X2</span>,tf<span class="op">=</span><span class="va">sqFun</span><span class="op">)</span>,data<span class="op">=</span><span class="va">d</span>,cause<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in qFun(c(0.223312599010185, 0.844653052602936, 0.86743957909998, 0.869654848917858, 1.4718454380646, 1.47986846377743, 1.56788544286003, 1.57284176822651, 1.71280654079967, 1.7446175554818, 2.08017045127398, 2.11900022748555, 2.34027091945108, 2.44735526652256, 2.47481572672078, 2.69072148768644, 2.69930631257876, 2.82681955875637, 2.86986677073091, 3.28835303045329, 3.38016548882937, 3.42930837661085, 3.57927210122299, 3.61310741873331, 3.71589696889436, 3.82638651755888, 4.13125614409393, 4.22817648821086, 4.69740197012358, 4.75934581546958, 4.7989296471193, 5.09144457759695, 5.20599159981632, 5.27409575450788, 5.37841476839829, 5.45365210472182, 5.47792252614271, 5.8344164585106, 6.03541407396753, 6.63251816105419, 6.92722896832721, 7.2931295159595, 7.59440495376659, 7.82755206098875, 8.10614220085668, 8.1127149986577, 8.83868607919211, 9.05983471886304, 9.33426459771812, 10.6845775000325)):</span> could not find function "qFun"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## additional arguments for crr</span></span></span>
<span class="r-in"><span><span class="va">f6</span><span class="op">&lt;-</span> <span class="fu">FGR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,data<span class="op">=</span><span class="va">d</span>, cause<span class="op">=</span><span class="fl">1</span>,gtol<span class="op">=</span><span class="fl">1e-5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f6</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Right-censored response of a competing.risks model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.Observations: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pattern:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cause     event right.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1          50              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2          29              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   unknown     0             21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fine-Gray model: analysis of cause 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Competing Risks Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FGR(formula = Hist(time, cause) ~ X1 + X2, data = d, cause = 1, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     gtol = 1e-05)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     coef exp(coef) se(coef)    z p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1 0.834      2.30    0.309 2.70 6.9e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2 0.723      2.06    0.137 5.28 1.3e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    exp(coef) exp(-coef) 2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      2.30      0.434 1.26  4.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2      2.06      0.485 1.58  2.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. cases = 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo Log-likelihood = -190 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo likelihood ratio test = 28.3  on 2 df,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">f6a</span><span class="op">&lt;-</span> <span class="fu">FGR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,data<span class="op">=</span><span class="va">d</span>, cause<span class="op">=</span><span class="fl">1</span>,gtol<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f6a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Right-censored response of a competing.risks model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.Observations: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pattern:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cause     event right.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1          50              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2          29              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   unknown     0             21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fine-Gray model: analysis of cause 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Competing Risks Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FGR(formula = Hist(time, cause) ~ X1 + X2, data = d, cause = 1, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     gtol = 0.1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     coef exp(coef) se(coef)    z p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1 0.895      2.45    0.316 2.83 4.7e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2 0.774      2.17    0.141 5.48 4.1e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    exp(coef) exp(-coef) 2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      2.45      0.409 1.32  4.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2      2.17      0.461 1.64  2.86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. cases = 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo Log-likelihood = -190 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pseudo likelihood ratio test = 28.1  on 2 df,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Thomas Alexander Gerds, Johan Sebastian Ohlendorff, Brice Ozenne.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

