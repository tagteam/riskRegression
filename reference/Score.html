<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Methods to score the predictive performance of risk markers and risk prediction models"><title>Score risk predictions — Score • riskRegression</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Score risk predictions — Score"><meta property="og:description" content="Methods to score the predictive performance of risk markers and risk prediction models"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">riskRegression</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2022.02.28</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tagteam/riskRegression/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Score risk predictions</h1>
      <small class="dont-index">Source: <a href="https://github.com/tagteam/riskRegression/blob/HEAD/R/Score.R" class="external-link"><code>R/Score.R</code></a></small>
      <div class="d-none name"><code>Score.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Methods to score the predictive performance of risk markers and risk prediction models</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">Score</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for list</span>
<span class="fu">Score</span><span class="op">(</span>
  <span class="va">object</span>,
  <span class="va">formula</span>,
  <span class="va">data</span>,
  metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auc"</span>, <span class="st">"brier"</span><span class="op">)</span>,
  summary <span class="op">=</span> <span class="cn">NULL</span>,
  plots <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">cause</span>,
  <span class="va">times</span>,
  <span class="va">landmarks</span>,
  use.event.times <span class="op">=</span> <span class="cn">FALSE</span>,
  null.model <span class="op">=</span> <span class="cn">TRUE</span>,
  se.fit <span class="op">=</span> <span class="cn">TRUE</span>,
  conservative <span class="op">=</span> <span class="cn">FALSE</span>,
  multi.split.test <span class="op">=</span> <span class="cn">FALSE</span>,
  conf.int <span class="op">=</span> <span class="fl">0.95</span>,
  contrasts <span class="op">=</span> <span class="cn">TRUE</span>,
  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span>,
  cens.method <span class="op">=</span> <span class="st">"ipcw"</span>,
  cens.model <span class="op">=</span> <span class="st">"cox"</span>,
  <span class="va">split.method</span>,
  <span class="va">B</span>,
  <span class="va">M</span>,
  <span class="va">seed</span>,
  <span class="va">trainseeds</span>,
  parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"multicore"</span>, <span class="st">"snow"</span>, <span class="st">"as.registered"</span><span class="op">)</span>,
  ncpus <span class="op">=</span> <span class="fl">1</span>,
  cl <span class="op">=</span> <span class="cn">NULL</span>,
  progress.bar <span class="op">=</span> <span class="fl">3</span>,
  errorhandling <span class="op">=</span> <span class="st">"pass"</span>,
  <span class="va">keep</span>,
  <span class="va">predictRisk.args</span>,
  debug <span class="op">=</span> <span class="fl">0L</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>List of risk predictions (see details and examples).</p></dd>
<dt>...</dt>
<dd><p>Named list containging additional arguments that are passed on to the <code>predictRisk</code> methods corresponding to object. See examples.</p></dd>
<dt>formula</dt>
<dd><p>A formula which identifies the outcome (left hand
    side). E.g., <code>Y ~ 1</code> for binary and <code>Hist(time,status) ~ 1</code> for time-to-event outcome.
In right censored data, the right hand side of the
    formula is used to estimate the inverse probability of censoring weights (IPCW) model.</p></dd>
<dt>data</dt>
<dd><p><code>data.frame</code> or <code>data.table</code> in which the formula can be
interpreted.</p></dd>
<dt>metrics</dt>
<dd><p>Character vector specifying which metrics to
apply. Case does not matter. Choices are <code>"AUC"</code> and <code>"Brier"</code>.</p></dd>
<dt>summary</dt>
<dd><p>Character vector specifying which summary
statistics to apply to the predicted risks. Choices are <code>"risks"</code>, <code>"IPA"</code>,
<code>"riskQuantile"</code> and <code>"ibs"</code>. Can be all <code>c("risks","IPA","riskQuantile","ibs")</code> or a subset thereof.</p><ul><li><p><code>"risks"</code> adds the predicted risks to the output.</p></li>
<li><p><code>"ipa"</code> computes the index of prediction accuracy (AKA R-squared) based on Brier scores for model vs null model</p></li>
<li><p><code>"riskQuantile"</code> calculates
time-point specific boxplots for the
predicted risks (or biomarker values) conditional on the outcome at the time-point.</p></li>
<li><p><code>"ibs"</code> calculates integrated Brier scores across the time points at which the Brier score is computed. This works only with
time-to-event outcome and the results depend on the argument <code>times</code>.</p></li>
</ul><p>Set to <code>NULL</code> to avoid estimation of summary statistics.</p></dd>
<dt>plots</dt>
<dd><p>Character vector specifying for which plots to put data into the result.
Currently implemented are <code>"ROC"</code>, <code>"Calibration"</code> and <code>"boxplot"</code>.
In addition, one can plot AUC and Brier score as function of time as soon as
<code>times</code> has at least two different values.</p></dd>
<dt>cause</dt>
<dd><p>Event of interest. Used for binary outcome <code>Y</code>
to specify that risks are risks of the event <code>Y=event</code>
and for competing risks outcome to specify the cause of
interest.</p></dd>
<dt>times</dt>
<dd><p>For survival and competing risks outcome: list of
prediction horizons. All times which are greater than the
maximal observed time in the data set are automatically removed.
Note that the object returned by the function may become huge when
the prediction performance is estimated at many prediction horizons.</p></dd>
<dt>landmarks</dt>
<dd><p>Not yet implemented.</p></dd>
<dt>use.event.times</dt>
<dd><p>If <code>TRUE</code> merge all unique event times with
the vector given by argument <code>times</code>.</p></dd>
<dt>null.model</dt>
<dd><p>If <code>TRUE</code> fit a risk prediction model which ignores
    the covariates and predicts the same value for all subjects. The model is fitted using <code>data</code>
and the left hand side of <code>formula</code>. For binary outcome this is just the empirical prevalence. For (right censored) time to event outcome, the null models are
equal to the Kaplan-Meier estimator (no competing risks) and the Aalen-Johansen estimator (with competing risks).</p></dd>
<dt>se.fit</dt>
<dd><p>Logical or <code>0</code> or <code>1</code>. If <code>FALSE</code> or <code>0</code> do not calculate standard errors.</p></dd>
<dt>conservative</dt>
<dd><p>Logical, only relevant in right censored data. If <code>TRUE</code> ignore
variability of the estimate of the inverse probability of censoring weights when calculating standard
errors for prediction performance parameters. This can potentially reduce computation time and memory usage
at a usually very small expense of a slightly higher standard error.</p></dd>
<dt>multi.split.test</dt>
<dd><p>Logical or <code>0</code> or <code>1</code>. If <code>FALSE</code> or <code>0</code> do not calculate multi-split tests. This argument is ignored when <code>split.method</code> is "none".</p></dd>
<dt>conf.int</dt>
<dd><p>Either logical or a numeric value between 0 and 1. In right censored data,
confidence intervals are based on Blanche et al (see references). Setting <code>FALSE</code> prevents the
computation confidence intervals. <code>TRUE</code> means compute 95 percent confidence
intervals and corresponding p-values for AUC and Brier score. If set to 0.87, the
level of significance is 13 percent. So, do not set it to 0.87.</p></dd>
<dt>contrasts</dt>
<dd><p>Either logical or a list of contrasts. A list of contrasts defines which risk prediction models (markers)
 should be contrasted with respect to their prediction performance.
If <code>TRUE</code> do all possible comparisons. For
  example, when <code>object</code> is a list with two risk prediction models and
  <code>null.model=TRUE</code> setting <code>TRUE</code> is equivalent to
  <code>list(c(0,1,2),c(1,2))</code> where <code>c(0,1,2)</code> codes for the
  two comparisons: 1 vs 0 and 2 vs 0 (positive integers refer to
  elements of <code>object</code>, 0 refers to the benchmark null
  model which ignores the covariates).  This again is equivalent
  to explicitly setting <code>list(c(0,1),c(0,2),c(1,2))</code>. A
  more complex example: Suppose <code>object</code> has 7 elements and you
  want to do the following 3 comparisons: 6 vs 3, 2 vs 5 and 2
  vs 3, you should set <code>contrasts=c(6,3),c(2,5,3)</code>.</p></dd>
<dt>probs</dt>
<dd><p>Quantiles for retrospective summary statistics of the
predicted risks. This affects the result of the function <code>boxplot.Score</code>.</p></dd>
<dt>cens.method</dt>
<dd><p>Method for dealing with right censored
data. Either <code>"ipcw"</code> or <code>"pseudo"</code>.
Here IPCW refers to inverse probability of censoring weights and <code>pseudo</code> for jackknife pseudo values.
Right now pseudo values  are only used for calibration curves.</p></dd>
<dt>cens.model</dt>
<dd><p>Model for estimating inverse probability of
    censored weights. Implemented are the Kaplan-Meier method (<code>"km"</code>) and
Cox regression (<code>"cox"</code>) both applied to the censored times. If the right hand side of <code>formula</code> does not specify covariates,
the Kaplan-Meier method is used even if this argument is set to <code>"cox"</code>.</p></dd>
<dt>split.method</dt>
<dd><p>Method for cross-validation. Right now the only choice is <code>bootcv</code> in which case bootstrap learning sets
are drawn with our without replacement (argument <code>M</code>) from <code>data</code>. The data not included in the current bootstrap learning
set are used as validation set to compute the prediction performance.</p></dd>
<dt>B</dt>
<dd><p>Number of bootstrap sets for cross-validation.</p></dd>
<dt>M</dt>
<dd><p>Size of subsamples for bootstrap cross-validation. If specified it
has to be an integer smaller than the size of <code>data</code>.</p></dd>
<dt>seed</dt>
<dd><p>Super seed for setting training data seeds when
randomly splitting (bootstrapping) the data during cross-validation.</p></dd>
<dt>trainseeds</dt>
<dd><p>Seeds for training models during cross-validation.</p></dd>
<dt>parallel</dt>
<dd><p>The type of parallel operation to be used (if any). If missing, the default is <code>"no"</code>.</p></dd>
<dt>ncpus</dt>
<dd><p>integer: number of processes to be used in parallel operation.</p></dd>
<dt>cl</dt>
<dd><p>An optional <code>parallel</code> or <code>snow</code> cluster for use if <code>parallel = "snow"</code>. If not supplied, a cluster on the local machine is created for the duration of the <code>Score</code> call.</p></dd>
<dt>progress.bar</dt>
<dd><p>Style for <code>txtProgressBar</code>. Can be 1,2,3 see <code><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">help(txtProgressBar)</a></code> or NULL to avoid the progress bar.</p></dd>
<dt>errorhandling</dt>
<dd><p>Argument passed as <code>.errorhandling</code> to foreach. Default is <code>"pass"</code>.</p></dd>
<dt>keep</dt>
<dd><p>list of characters (not case sensitive) which determines additional output.
<code>"residuals"</code> provides Brier score residuals and
<code>"splitindex"</code> provides sampling index used to split the data into training and validation sets.
<code>"vcov"</code> provides the variance-covariance matrix of the estimated parameters.</p></dd>
<dt>predictRisk.args</dt>
<dd><p>A list of argument-lists to control how risks are predicted.
 The names of the lists should be the S3-classes of the <code>object</code>.
 The argument-lists are then passed on to the S3-class specific predictRisk method.
 For example, if your object contains one or several random forest model fitted with the function randomForestSRC::rfsrc then you can
 specify additional arguments for the function riskRegression::predictRisk.rfsrc which will pass
 these on to the function randomForestSRC::predict.rfsrc. A specific example in this case would be
 <code>list(rfsrc=list(na.action="na.impute"))</code>.</p>
<p>A more flexible approach is to write a new predictRisk S3-method. See Details.</p></dd>
<dt>debug</dt>
<dd><p>Logical. If <code>TRUE</code> indicate landmarks in progress of the program.</p></dd>
<dt>useEventTimes</dt>
<dd><p>obsolete.</p></dd>
<dt>nullModel</dt>
<dd><p>obsolete.</p></dd>
<dt>censMethod</dt>
<dd><p>obsolete.</p></dd>
<dt>censModel</dt>
<dd><p>obsolete.</p></dd>
<dt>splitMethod</dt>
<dd><p>obsolete.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with scores and assessments of contrasts, i.e.,
    tests and confidence limits for performance and difference in performance (AUC and Brier),
    summaries and plots. Most elements are in<code>data.table</code> format.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function implements a toolbox for the risk prediction modeller:
all tools work for the three outcomes: (1) binary (uncensored),
(2) right censored time to event without competing risks,
(3) right censored time to event with competing risks</p>
<p>Computed are the (time-dependent) Brier score and the (time-dependent)
area under the ROC curve for a list of risk prediction models either in
external validation data or in the learning data using bootstrap
cross-validation. The function optionally provides results for plotting (time-point specific)
ROC curves, for (time-point specific) calibration curves and for (time-point specific) retrospective boxplots.</p>
<p>For uncensored binary outcome the Delong-Delong test is used to contrast AUC of rival models.
In right censored survival data (with and without competing risks)
the p-values correspond to Wald tests based on standard errors obtained with an estimate of the influence function
as described in detail in the appendix of Blanche et al. (2015).</p>

<p>This function works with one or multiple models that predict the risk of an event R(t|X) for a subject
characterized by predictors X at time t.
With binary endpoints (outcome 0/1 without time component) the risk is simply R(X).
In case of a survival object
without competing risks the function still works with predicted event probabilities, i.e., R(t|X)=1-S(t|X) where
S(t|X) is the predicted survival chance for subject X at time t.</p>
<p>The already existing predictRisk methods (see methods(predictRisk)) may not cover all models and methods
for predicting risks. But users can quickly extend the package as explained in detail in Mogensen et al. (2012) for
the predecessors <code><a href="https://rdrr.io/pkg/pec/man/predictSurvProb.html" class="external-link">pec::predictSurvProb</a></code> and <code><a href="https://rdrr.io/pkg/pec/man/predictEventProb.html" class="external-link">pec::predictEventProb</a></code> which have been unified as
<code><a href="predictRisk.html">riskRegression::predictRisk</a></code>.</p>
<p>Bootstrap Crossvalidation (see also Gerds &amp; Schumacher 2007 and Mogensen et al. 2012)</p>
<p>B=10, M (not specified or M=NROW(data))
Training of each of the models in each of 10 bootstrap data sets (learning data sets).
Learning data sets are obtained by sampling <code>NROW(data)</code> subjects of the data set
with replacement. There are roughly <code>.632*NROW(data)</code> subjects in the learning data (inbag)
and <code>.368*NROW(data)</code> subjects not in the validation data sets (out-of-bag).</p>
<p>These are used to estimate the scores: AUC, Brier, etc. Reported are averages across the 10 splits.</p>
<p>## Bootstrap with replacement
<code>
set.seed(13)
N=17
data = data.frame(id=1:N, y=rbinom(N,1,.3),x=rnorm(N))
boot.index = sample(1:N,size=N,replace=TRUE)
boot.index
inbag = 1:N <!-- %in% boot.index -->
outofbag = !inbag
learn.data = data[inbag]
val.data = data[outofbag]
riskRegression:::getSplitMethod("bootcv",B=10,N=17)$index
</code>
NOTE: the number .632 is the expected probability to draw one subject (for example subject 1) with
replacement from the data, which does not depend on the sample size:
<code>B=10000</code>
<code>N=137</code>
<code>mean(sapply(1:B, function(b){match(1,sample(1:N,size=N,replace=TRUE),nomatch=0)}))</code>
<code>N=30</code>
<code>mean(sapply(1:B, function(b){match(1,sample(1:N,size=N,replace=TRUE),nomatch=0)}))</code>
<code>N=300</code>
<code>mean(sapply(1:B, function(b){match(1,sample(1:N,size=N,replace=TRUE),nomatch=0)}))</code></p>

<p>## Bootstrap without replacement (training size set to be 70 percent of data)
B=10, M=.7</p>
<p>Training of each of the models in each of 10 bootstrap data sets (learning data sets).
Learning data sets are obtained by sampling <code>round(.8*NROW(data))</code> subjects of the data set
without replacement. There are <code>NROW(data)-round(.8*NROW(data))</code> subjects not in the learning data sets.
These are used to estimate the scores: AUC, Brier, etc. Reported are averages across the 10 splits.
<code>
set.seed(13)
N=17
data = data.frame(id=1:N, y=rbinom(N,1,.3),x=rnorm(N))
boot.index = sample(1:N,size=M,replace=FALSE)
boot.index
inbag = 1:N <!-- %in% boot.index -->
outofbag = !inbag
learn.data = data[inbag]
val.data = data[outofbag]
riskRegression:::getSplitMethod("bootcv",B=10,N=17,M=.7)$index
</code></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ulla B. Mogensen, Hemant Ishwaran, Thomas A. Gerds (2012).
Evaluating Random Forests for Survival Analysis Using Prediction Error
Curves. Journal of Statistical Software, 50(11), 1-23. URL
http://www.jstatsoft.org/v50/i11/.</p>
<p>Paul Blanche, Cecile Proust-Lima, Lucie Loubere, Claudine Berr, Jean- Francois Dartigues, and
Helene Jacqmin-Gadda. Quantifying and comparing dynamic predictive accuracy of joint models
for longitudinal marker and time-to-event in presence of censoring and competing risks.
Biometrics, 71 (1):102--113, 2015.</p>
<p>P. Blanche, J-F Dartigues, and H. Jacqmin-Gadda. Estimating and comparing
time-dependent areas under receiver operating characteristic curves for
censored event times with competing risks. Statistics in Medicine,
32(30):5381--5397, 2013.</p>
<p>E. Graf et al.  (1999), Assessment and comparison of prognostic
classification schemes for survival data. Statistics in Medicine, vol 18,
pp= 2529--2545.</p>
<p>Efron, Tibshirani (1997) Journal of the American Statistical Association 92,
548--560 Improvement On Cross-Validation: The .632+ Bootstrap Method.</p>
<p>Gerds, Schumacher (2006), Consistent estimation of the expected Brier score
in general survival models with right-censored event times. Biometrical
Journal, vol 48, 1029--1040.</p>
<p>Thomas A. Gerds, Martin Schumacher (2007) Efron-Type Measures of Prediction
Error for Survival Analysis Biometrics, 63(4), 1283--1287
doi:10.1111/j.1541-0420.2007.00832.x</p>
<p>Martin Schumacher, Harald Binder, and Thomas Gerds. Assessment of survival
prediction models based on microarray data. Bioinformatics, 23(14):1768-74,
2007.</p>
<p>Mark A. van de Wiel, Johannes Berkhof, and Wessel N. van Wieringen Testing
the prediction error difference between 2 predictors Biostatistics (2009)
10(3): 550-560 doi:10.1093/biostatistics/kxp011</p>
<p>Michael W Kattan and Thomas A Gerds. The index of prediction accuracy: an
intuitive measure useful for evaluating risk prediction models. Diagnostic
and Prognostic Research, 2(1):7, 2018.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas A Gerds <a href="mailto:tag@biostat.ku.dk">tag@biostat.ku.dk</a> and Paul Blanche <a href="mailto:paul.blanche@univ-ubs.fr">paul.blanche@univ-ubs.fr</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># binary outcome</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/lava/" class="external-link">lava</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span></span>
<span class="r-in"><span class="va">learndat</span> <span class="op">&lt;-</span> <span class="fu"><a href="sampleData.html">sampleData</a></span><span class="op">(</span><span class="fl">48</span>,outcome<span class="op">=</span><span class="st">"binary"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">testdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="sampleData.html">sampleData</a></span><span class="op">(</span><span class="fl">40</span>,outcome<span class="op">=</span><span class="st">"binary"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## score logistic regression models</span></span>
<span class="r-in"><span class="va">lr1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X9</span>,data<span class="op">=</span><span class="va">learndat</span>,family<span class="op">=</span><span class="va">binomial</span><span class="op">)</span></span>
<span class="r-in"><span class="va">lr2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X3</span><span class="op">+</span><span class="va">X5</span>,data<span class="op">=</span><span class="va">learndat</span>,family<span class="op">=</span><span class="va">binomial</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"LR(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">lr1</span>,<span class="st">"LR(X3+X5)"</span><span class="op">=</span><span class="va">lr2</span><span class="op">)</span>,formula<span class="op">=</span><span class="va">Y</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">testdat</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Metric AUC:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results by model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              model  AUC lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: LR(X1+X2+X7+X9) 60.7  42.3  79.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:       LR(X3+X5) 44.2  26.9  61.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of model comparisons:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        model       reference delta.AUC lower upper   p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: LR(X3+X5) LR(X1+X2+X7+X9)     -16.4 -38.2   5.3 0.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: Values are multiplied by 100 and given in %.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: The higher AUC the better.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Metric Brier:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results by model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              model Brier lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:      Null model  24.9  24.2  25.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: LR(X1+X2+X7+X9)  27.9  19.0  36.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:       LR(X3+X5)  25.4  24.0  26.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of model comparisons:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              model       reference delta.Brier lower upper         p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: LR(X1+X2+X7+X9)      Null model         3.0  -5.9  11.8 0.5124805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:       LR(X3+X5)      Null model         0.5  -0.4   1.4 0.2747143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:       LR(X3+X5) LR(X1+X2+X7+X9)        -2.5 -11.1   6.2 0.5778617</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: Values are multiplied by 100 and given in %.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: The lower Brier the better.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ROC curve and calibration plot</span></span>
<span class="r-in"><span class="va">xb</span><span class="op">=</span><span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"LR(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">lr1</span>,<span class="st">"LR(X3+X5+X6)"</span><span class="op">=</span><span class="va">lr2</span><span class="op">)</span>,formula<span class="op">=</span><span class="va">Y</span><span class="op">~</span><span class="fl">1</span>,</span>
<span class="r-in">         data<span class="op">=</span><span class="va">testdat</span>,plots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"calibration"</span>,<span class="st">"ROC"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu"><a href="plotROC.html">plotROC</a></span><span class="op">(</span><span class="va">xb</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotCalibration.html">plotCalibration</a></span><span class="op">(</span><span class="va">xb</span><span class="op">)</span></span>
<span class="r-plt img"><img src="Score-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## compute AUC for a list of continuous markers</span></span>
<span class="r-in"><span class="va">markers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">testdat</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">X6</span>,<span class="va">X7</span>,<span class="va">X8</span>,<span class="va">X9</span>,<span class="va">X10</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">Score</span><span class="op">(</span><span class="va">markers</span>,formula<span class="op">=</span><span class="va">Y</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">testdat</span>,metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auc"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Metric AUC:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results by model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    model  AUC lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:    X6 86.7  75.3  98.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:    X7 38.6  20.7  56.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:    X8 46.4  27.7  65.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:    X9 35.3  17.9  52.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:   X10 46.4  27.8  65.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of model comparisons:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model reference delta.AUC lower upper     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:    X7        X6     -48.1 -69.7 -26.6 1e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:    X8        X6     -40.4 -63.6 -17.1 7e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:    X9        X6     -51.4 -73.3 -29.4 4e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:   X10        X6     -40.4 -61.8 -18.9 2e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:    X8        X7       7.8 -17.0  32.6 5e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:    X9        X7      -3.3 -26.6  20.1 8e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:   X10        X7       7.8 -17.4  32.9 5e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:    X9        X8     -11.0 -34.8  12.7 4e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:   X10        X8       0.0 -27.4  27.4 1e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:   X10        X9      11.0 -12.1  34.2 4e-01</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: Values are multiplied by 100 and given in %.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: The higher AUC the better.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># cross-validation</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="va">learndat</span><span class="op">=</span><span class="fu"><a href="sampleData.html">sampleData</a></span><span class="op">(</span><span class="fl">400</span>,outcome<span class="op">=</span><span class="st">"binary"</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">lr1a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X6</span>,data<span class="op">=</span><span class="va">learndat</span>,family<span class="op">=</span><span class="va">binomial</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">lr2a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X7</span><span class="op">+</span><span class="va">X8</span><span class="op">+</span><span class="va">X9</span>,data<span class="op">=</span><span class="va">learndat</span>,family<span class="op">=</span><span class="va">binomial</span><span class="op">)</span></span>
<span class="r-in">    <span class="co">## bootstrap cross-validation</span></span>
<span class="r-in">    <span class="va">x1</span><span class="op">=</span><span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"LR1"</span><span class="op">=</span><span class="va">lr1a</span>,<span class="st">"LR2"</span><span class="op">=</span><span class="va">lr2a</span><span class="op">)</span>,formula<span class="op">=</span><span class="va">Y</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">learndat</span>,split.method<span class="op">=</span><span class="st">"bootcv"</span>,B<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">x1</span></span>
<span class="r-in">    <span class="co">## leave-one-out and leave-pair-out bootstrap</span></span>
<span class="r-in">    <span class="va">x2</span><span class="op">=</span><span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"LR1"</span><span class="op">=</span><span class="va">lr1a</span>,<span class="st">"LR2"</span><span class="op">=</span><span class="va">lr2a</span><span class="op">)</span>,formula<span class="op">=</span><span class="va">Y</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">learndat</span>,</span>
<span class="r-in">             split.method<span class="op">=</span><span class="st">"loob"</span>,</span>
<span class="r-in">             B<span class="op">=</span><span class="fl">100</span>,plots<span class="op">=</span><span class="st">"calibration"</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">x2</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="co"># survival outcome</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Score Cox regression models</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/rms/" class="external-link">rms</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Hmisc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: lattice</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Formula</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: ggplot2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘ggplot2’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:lava’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     vars</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘Hmisc’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     format.pval, units</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: SparseM</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘SparseM’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     backsolve</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘rms’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:modeltools’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Predict</span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">prodlim</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span></span>
<span class="r-in"><span class="va">trainSurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="sampleData.html">sampleData</a></span><span class="op">(</span><span class="fl">100</span>,outcome<span class="op">=</span><span class="st">"survival"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">testSurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="sampleData.html">sampleData</a></span><span class="op">(</span><span class="fl">40</span>,outcome<span class="op">=</span><span class="st">"survival"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cox1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X9</span>,data<span class="op">=</span><span class="va">trainSurv</span>, y<span class="op">=</span><span class="cn">TRUE</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cox2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">X3</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span>,data<span class="op">=</span><span class="va">trainSurv</span>, y<span class="op">=</span><span class="cn">TRUE</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">xs</span><span class="op">=</span><span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Cox(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">cox1</span>,<span class="st">"Cox(X3+X5+X6)"</span><span class="op">=</span><span class="va">cox2</span><span class="op">)</span>,</span>
<span class="r-in">         formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">testSurv</span>,conf.int<span class="op">=</span><span class="cn">FALSE</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">xs</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Metric AUC:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results by model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               model times  AUC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: Cox(X1+X2+X7+X9)     5 65.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: Cox(X1+X2+X7+X9)     8 69.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:    Cox(X3+X5+X6)     5 74.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:    Cox(X3+X5+X6)     8 77.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of model comparisons:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    times         model        reference delta.AUC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:     5 Cox(X3+X5+X6) Cox(X1+X2+X7+X9)       8.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:     8 Cox(X3+X5+X6) Cox(X1+X2+X7+X9)       8.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: Values are multiplied by 100 and given in %.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: The higher AUC the better.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Metric Brier:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results by model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               model times Brier</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:       Null model     5  23.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:       Null model     8  24.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: Cox(X1+X2+X7+X9)     5  22.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: Cox(X1+X2+X7+X9)     8  22.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:    Cox(X3+X5+X6)     5  22.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:    Cox(X3+X5+X6)     8  20.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of model comparisons:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    times            model        reference delta.Brier</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:     5 Cox(X1+X2+X7+X9)       Null model        -0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:     5    Cox(X3+X5+X6)       Null model        -1.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:     5    Cox(X3+X5+X6) Cox(X1+X2+X7+X9)        -0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:     8 Cox(X1+X2+X7+X9)       Null model        -1.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:     8    Cox(X3+X5+X6)       Null model        -4.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:     8    Cox(X3+X5+X6) Cox(X1+X2+X7+X9)        -2.8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: Values are multiplied by 100 and given in %.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: The lower Brier the better.</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Integrated Brier score</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">xs</span><span class="op">=</span><span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Cox(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">cox1</span>,<span class="st">"Cox(X3+X5+X6)"</span><span class="op">=</span><span class="va">cox2</span><span class="op">)</span>,</span>
<span class="r-in">         formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">testSurv</span>,conf.int<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span class="r-in">         summary<span class="op">=</span><span class="st">"ibs"</span>,</span>
<span class="r-in">         times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">testSurv</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># time-dependent AUC for list of markers</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="va">survmarkers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">testSurv</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">X6</span>,<span class="va">X7</span>,<span class="va">X8</span>,<span class="va">X9</span>,<span class="va">X10</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">Score</span><span class="op">(</span><span class="va">survmarkers</span>,</span>
<span class="r-in">      formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,metrics<span class="op">=</span><span class="st">"auc"</span>,data<span class="op">=</span><span class="va">testSurv</span>,</span>
<span class="r-in">      conf.int<span class="op">=</span><span class="cn">TRUE</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in Score(survmarkers, formula = Surv(time, event) ~ 1, metrics = "auc",     data = testSurv, conf.int = TRUE, times = c(5, 8)):</span> object 'survmarkers' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># compare models on test data</span></span>
<span class="r-in"><span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Cox(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">cox1</span>,<span class="st">"Cox(X3+X5+X6)"</span><span class="op">=</span><span class="va">cox2</span><span class="op">)</span>,</span>
<span class="r-in">      formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">testSurv</span>,conf.int<span class="op">=</span><span class="cn">TRUE</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in rowSumsCrossprodSpec(htij1, MC.Ti.cases):</span> Not compatible with requested type: [type=NULL; target=double].</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># crossvalidation models in traindata</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">trainSurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="sampleData.html">sampleData</a></span><span class="op">(</span><span class="fl">400</span>,outcome<span class="op">=</span><span class="st">"survival"</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">cox1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X9</span>,data<span class="op">=</span><span class="va">trainSurv</span>, y<span class="op">=</span><span class="cn">TRUE</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">cox2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">X3</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span>,data<span class="op">=</span><span class="va">trainSurv</span>, y<span class="op">=</span><span class="cn">TRUE</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">x1</span> <span class="op">=</span> <span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Cox(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">cox1</span>,<span class="st">"Cox(X3+X5+X6)"</span><span class="op">=</span><span class="va">cox2</span><span class="op">)</span>,</span>
<span class="r-in">               formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">trainSurv</span>,conf.int<span class="op">=</span><span class="cn">TRUE</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span>,</span>
<span class="r-in">               split.method<span class="op">=</span><span class="st">"loob"</span>,B<span class="op">=</span><span class="fl">100</span>,plots<span class="op">=</span><span class="st">"calibration"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">    <span class="va">x2</span><span class="op">=</span> <span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Cox(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">cox1</span>,<span class="st">"Cox(X3+X5+X6)"</span><span class="op">=</span><span class="va">cox2</span><span class="op">)</span>,</span>
<span class="r-in">              formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">trainSurv</span>,conf.int<span class="op">=</span><span class="cn">TRUE</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span>,</span>
<span class="r-in">              split.method<span class="op">=</span><span class="st">"bootcv"</span>,B<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># restrict number of comparisons</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Cox(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">cox1</span>,<span class="st">"Cox(X3+X5+X6)"</span><span class="op">=</span><span class="va">cox2</span><span class="op">)</span>,</span>
<span class="r-in">          formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">trainSurv</span>,contrasts<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span class="r-in">          null.model<span class="op">=</span><span class="cn">FALSE</span>,conf.int<span class="op">=</span><span class="cn">TRUE</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span>,split.method<span class="op">=</span><span class="st">"bootcv"</span>,B<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">    <span class="co"># competing risks outcome</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">trainCR</span> <span class="op">&lt;-</span> <span class="fu"><a href="sampleData.html">sampleData</a></span><span class="op">(</span><span class="fl">40</span>,outcome<span class="op">=</span><span class="st">"competing.risks"</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">testCR</span> <span class="op">&lt;-</span> <span class="fu"><a href="sampleData.html">sampleData</a></span><span class="op">(</span><span class="fl">40</span>,outcome<span class="op">=</span><span class="st">"competing.risks"</span><span class="op">)</span></span>
<span class="r-in">    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tagteam/riskRegression" class="external-link">riskRegression</a></span><span class="op">)</span></span>
<span class="r-in">    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.R-project.org" class="external-link">cmprsk</a></span><span class="op">)</span></span>
<span class="r-in">    <span class="co"># Cause-specific Cox regression</span></span>
<span class="r-in">    <span class="va">csc1</span> <span class="op">=</span> <span class="fu"><a href="CSC.html">CSC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X9</span>,data<span class="op">=</span><span class="va">trainCR</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">csc2</span> <span class="op">=</span> <span class="fu"><a href="CSC.html">CSC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">X3</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span>,data<span class="op">=</span><span class="va">trainCR</span><span class="op">)</span></span>
<span class="r-in">    <span class="co"># Fine-Gray regression</span></span>
<span class="r-in">    <span class="va">fgr1</span> <span class="op">=</span> <span class="fu"><a href="FGR.html">FGR</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X9</span>,data<span class="op">=</span><span class="va">trainCR</span>,cause<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">fgr2</span> <span class="op">=</span> <span class="fu"><a href="FGR.html">FGR</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">X3</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span>,data<span class="op">=</span><span class="va">trainCR</span>,cause<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"CSC(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">csc1</span>,<span class="st">"CSC(X3+X5+X6)"</span><span class="op">=</span><span class="va">csc2</span>,</span>
<span class="r-in">               <span class="st">"FGR(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">fgr1</span>,<span class="st">"FGR(X3+X5+X6)"</span><span class="op">=</span><span class="va">fgr2</span><span class="op">)</span>,</span>
<span class="r-in">          formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">testCR</span>,se.fit<span class="op">=</span><span class="fl">1L</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="co"># reproduce some results of Table IV of Blanche et al. Stat Med 2013</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Paquid</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">ResPaquid</span> <span class="op">&lt;-</span> <span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"DSST"</span><span class="op">=</span><span class="op">-</span><span class="va">Paquid</span><span class="op">$</span><span class="va">DSST</span>,<span class="st">"MMSE"</span><span class="op">=</span><span class="op">-</span><span class="va">Paquid</span><span class="op">$</span><span class="va">MMSE</span><span class="op">)</span>,</span>
<span class="r-in">                       formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,</span>
<span class="r-in">                       data<span class="op">=</span><span class="va">Paquid</span>,</span>
<span class="r-in">                       null.model <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">                       conf.int<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span class="r-in">                       metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auc"</span><span class="op">)</span>,</span>
<span class="r-in">                       times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">                       plots<span class="op">=</span><span class="st">"ROC"</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">ResPaquid</span></span>
<span class="r-in">    <span class="fu"><a href="plotROC.html">plotROC</a></span><span class="op">(</span><span class="va">ResPaquid</span>,time<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># parallel options</span></span>
<span class="r-in"><span class="co"># by erikvona: Here is a generic example of using future</span></span>
<span class="r-in"><span class="co"># and doFuture, works great with the current version:</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tagteam/riskRegression" class="external-link">riskRegression</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/foreach" class="external-link">foreach</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HenrikBengtsson/doFuture" class="external-link">doFuture</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Register all available cores for parallel operation</span></span>
<span class="r-in"><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multiprocess</span>, workers <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/re-exports.html" class="external-link">availableCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">registerDoFuture</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">trainSurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="sampleData.html">sampleData</a></span><span class="op">(</span><span class="fl">400</span>,outcome<span class="op">=</span><span class="st">"survival"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cox1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X9</span>,data<span class="op">=</span><span class="va">trainSurv</span>,</span>
<span class="r-in">             y<span class="op">=</span><span class="cn">TRUE</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Bootstrapping on multiple cores</span></span>
<span class="r-in"><span class="va">x1</span> <span class="op">=</span> <span class="fu">Score</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Cox(X1+X2+X7+X9)"</span><span class="op">=</span><span class="va">cox1</span><span class="op">)</span>,</span>
<span class="r-in">     formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">trainSurv</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span>,</span>
<span class="r-in">     parallel <span class="op">=</span> <span class="st">"as.registered"</span>, split.method<span class="op">=</span><span class="st">"bootcv"</span>,B<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Thomas Alexander Gerds, Brice Ozenne.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

